<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<link rel="stylesheet" href="../lib/layui-v2.5.4/css/layui.css">
		<link rel="stylesheet" href="../lib/layui-v2.5.4/css/soulTable.css" media="all">
		<link rel="stylesheet" href="../css/layuimini.css" media="all">
	</head>
	<body>
		<form class="layui-form" action="" style="width: 100%;">
			<div class="layui-form-item" style="margin-left: -80px;background-color: #f6f8f8;">
				<br />
				<div class="layui-inline">
					<div class="layui-form-item">
						<div class="layui-inline">
							<div class="layui-input-block">
									<span style="font-size: 20px; line-height: 30px;"> 订单号码</span>
									<button type="button" class="layui-btn layui-btn-normal layui-btn-xs" id="selectOrder">选择订单</button>
							</div>
							<div class="layui-input-block">
								<div class="layui-input-inline">
									<input type="text" name="oid" placeholder="请输入" id="oid" required lay-verify="required" readonly="readonly" autocomplete="off"
									 class="layui-input" style="width: 260px;height: 50px;">
								</div>
							</div>
						</div>
						<div class="layui-inline">
							<div class="layui-input-block">
								<span style="font-size: 20px; line-height: 30px;"> 板号</span>
								<button type="button" class="layui-btn layui-btn-normal layui-btn-xs" id="b">选择板号</button>

							</div>
							<div class="layui-input-block">
								<div class="layui-input-inline">
									<input type="text" name="plateNo" id="plateNo" placeholder="请输入" readonly="readonly" required lay-verify="required" autocomplete="off"
									 class="layui-input"  style="width: 260px;height: 50px;">
								</div>
							</div>
						</div>
					</div>
					<br /><br />
					<div class="layui-form-item">
						<div class="layui-inline">
							<div class="layui-input-block">
								<h2>货物类型</h2>
							</div>
							<div class="layui-input-block">
								<div class="layui-input-inline">
									<input type="text"  name="goodsTypeName" id="goodsTypeName" readonly="readonly" required lay-verify="required" placeholder="请输入" autocomplete="off"
									 class="layui-input"  style="width: 260px;height: 50px;">
								</div>
							</div>
						</div>
						<div class="layui-inline">
							<div class="layui-input-block">
								<h2>寄件网点</h2>
							</div>
							<div class="layui-input-block">
								<div class="layui-input-inline">
									<input type="text" placeholder="请输入" name="mailingOutletsName" id="mailingOutletsName" required lay-verify="required" readonly="readonly" autocomplete="off"
									 class="layui-input"  style="width: 260px;height: 50px;">
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="layui-inline" style="margin-left: 70px;">
					<p style="background-color: #f5f5f5; width: 100%; line-height: 25px;"><span style="background-color: #00c1de;">&nbsp;</span>板号规则</p>
					<div class="layui-form-item">
						<p style="line-height: 32px;">上板策略</p>
						<div class="layui-input-inline">
							<input readonly="readonly" type="text" name="boardStrategy" id="boardStrategy" style="width: 180px;border: 1px solid #d1d1d1;height: 30px;">
						</div>
						<div style="line-height: 32px">
							<button type="button" class="layui-btn layui-btn-normal layui-btn-xs">新板号</button>
							<button type="button" class="layui-btn layui-btn-normal layui-btn-xs">上板设置</button>
						</div>
					</div>
					<div class="layui-form-item">
						<p style="line-height: 30px;">
							<span>派件网点</span>
							<span style="margin-left: 78px;">目的地</span>
							<span style="margin-left: 44px;">报关方式</span>
							<span style="margin-left: 26px;">货物类型</span>
						</p>
						<input type="text"readonly="readonly" id="deliveryOutlets" name="deliveryOutlets" style="width: 120px;border: 1px solid #d1d1d1;height: 20px;" />&nbsp;&nbsp;&nbsp;
						<input type="text"readonly="readonly" id="destination" name="destination" style="width: 70px;border: 1px solid #d1d1d1;height: 20px;" />&nbsp;&nbsp;&nbsp;
						<input type="text"readonly="readonly" id="customsDeclarationMethod" name="customsDeclarationMethod" style="width: 70px;border: 1px solid #d1d1d1;height: 20px;" />&nbsp;&nbsp;&nbsp;
						<input type="text"readonly="readonly" id="goodsType" name="goodsType" style="width: 70px;border: 1px solid #d1d1d1;height: 20px;" />
					</div>
					<div class="layui-form-item">
						<p style="line-height: 30px;">
							<span>走货路线</span>
							<span style="margin-left: 137px;">目的地机场代码</span>
							<span style="margin-left: 24px;">单票限制重量</span>
						</p>
						<input type="text"readonly="readonly" id="takeTheCargoRoute" name="takeTheCargoRoute" style="width: 180px;border: 1px solid #d1d1d1;height: 20px;" />&nbsp;&nbsp;&nbsp;
						<input type="text"readonly="readonly" id="destinationAirportCode" name="destinationAirportCode" style="width: 110px;border: 1px solid #d1d1d1;height: 20px;" />&nbsp;&nbsp;&nbsp;
						<input type="text"readonly="readonly" id="restrictedWeightPerTicket" name="restrictedWeightPerTicket" style="width: 110px;border: 1px solid #d1d1d1;height: 20px;" />
					</div>
				</div>
				</div>
				<div style="margin-left: 10px;margin-right: 10px;">
					<table class="layui-hide"  id="test"></table>
					<button type="button" class="layui-btn layui-btn-normal" style="width: 120px;" id="updOrder">上板完成</button>
					<a href="javascript:void(0)"  data-iframe-tab="BoardManagement.html" data-title="上板管理" data-icon="fa fa-hourglass-end" ><button type="button" class="layui-btn layui-btn-normal" style="width: 120px;">上板管理</button></a>
				</div>
		</form>
	</body>
	<script src="../lib/layui-v2.5.4/layui.js"></script>
	<script src="../js/lay-config.js?v=1.0.4" charset="utf-8"></script>
	<script>
		var oid;
		var goodsTypeName;
		var mailingOutletsName;
		var plateNo;
		layui.use(['layer', 'form', 'jquery', 'table','element','layuimini'], function() {
			var $ = layui.jquery,
			 layer = layui.layer,
			 form = layui.form,
			table = layui.table, 
			element = layui.element;

			$("#boardStrategy").load("/up/getBS",function(result){
				$("#boardStrategy").append("<option value=''>请选择</option>");
				$.each(eval("("+result+")"),function(index,item){
					$("#boardStrategy").append("<option value='"+item.bid+"'>"+item.tboardStrategy+"</option>");
				})
				form.render();
			})

			$("#updOrder").click(function () {
				if(oid==null){
					layer.msg("请选择订单")
				}else if(plateNo==null){
					layer.msg("请选择板号")
				}else{
					$.ajax({
						url:"/up/updOrderById",
						type:"post",
						dataType:"text",
						data:{"pno":plateNo,"oid":oid},
						success:function (result) {
							if(result>0){
								layer.msg("上板成功")
							}else{
								layer.msg("上板失败")
							}
						}
					})
				}
			})

			table.render({
				elem: '#test',
				url: "/up/getUP",
				cellMinWidth: 80, //全局定义常规单元格的最小宽度，layui 2.2.1 新增,
				height:330,
				toolbar: true,
				defaultToolbar: ['filter', 'print', 'exports'],
				cols: [
					[{
							field: 'buildBoardDate',
							title: '扫描时间',
						}, {
							field: 'uid',
							title: '扫描单号'
						}, {
							field: 'plateNo',
							title: '板号',
						},{
							field: 'dname',
							title: '目的地',
						}, {
							field: 'takeTheCargoRouteName',
							title: '走货路线',
						}, {
							field: 'cdmName',
							title: '报关类型',
						}, {
							field: 'gname',
							title: '货物类型',
						},{
							field: 'upperPlateOutletsName',
							title: '上板网点',
						},{
							field: 'ocount',
							title: '订单数',
						} , {
							field: 'buildBoardDate',
							title: '建板日期',
						}, {
							field: 'creatorName',
							title: '建板人',
						}
					]
				]
				,page: true
				,limit: 2
				, limits:[2,3,4]
			});
			
			$("#selectOrder").click(function() {
				layer.open({
					type: 2,
					content: "selectOrder.html",
					area: ['800px', '500px'],
					title: '选择订单',
					end: function(layero, index) {
						if(oid!=null){
							$("#oid").val(oid);
							$("#goodsTypeName").val(goodsTypeName);
							$("#mailingOutletsName").val(mailingOutletsName);
						}
					}
				});
			})

			$("#b").click(function() {
				layer.open({
					type: 2,
					content: "SelectNumberPlate.html",
					area: ['800px', '500px'],
					title: '选择板号',
					end: function(layero, index) {
						if(plateNo!=null){
							$("#plateNo").val(plateNo);
							$.ajax({
								url:"/up/getUPByPlateNo",
								type:"post",
								dataType:"json",
								data:{'plateNo':plateNo},
								success:function(result){
									$("#boardStrategy").val(result.bname);
									$("#deliveryOutlets").val(result.upperPlateOutletsName);
									$("#destination").val(result.dname);
									$("#goodsType").val(result.gname);
									$("#takeTheCargoRoute").val(result.takeTheCargoRouteName);
									$("#destinationAirportCode").val(result.destinationAirportCode);
									$("#customsDeclarationMethod").val(result.cdmName);
									$("#restrictedWeightPerTicket").val(result.restrictedWeightPerTicket);
								}
							})
						}
					}
				});
			})
		});
	</script>
</html>
