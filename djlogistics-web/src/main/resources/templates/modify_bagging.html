<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>修改装袋</title>
	<link rel="stylesheet" href="../lib/layui-v2.5.4/css/layui.css">
	<link rel="stylesheet" href="../lib/layui-v2.5.4/css/soulTable.css" media="all">
</head>
<body>
<br />
<div style="margin-left: 25px;">
	<form class="layui-form layui-form-pane" action="">
		<p style="background-color: #f5f5f5; width: 97%; line-height: 30px;"><span style="background-color: #00c1de;">&nbsp;</span>&nbsp;&nbsp;板号信息</p>
		<div style="margin-left: 10px;">
			<div class="layui-form-item">
				<div class="layui-inline">
					<div class="layui-form-item">
						袋号
					</div>
					<div class="layui-form-item" style="width: 160px;">
						<input type="text" readonly="readonly" name="plateNo" id="plateNo" required lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-inline">
					<div class="layui-form-item">
						清关袋号
					</div>
					<div class="layui-form-item" style="width: 160px;">
						<input type="text" name="customsClearanceBagNo" id="customsClearanceBagNo" required lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-inline">
					<div class="layui-form-item">
						装袋策略
					</div>
					<div class="layui-form-item" style="width: 160px;">
						<select name="baggingStrategy" id="baggingStrategy" lay-verify="required">
						</select>
					</div>
				</div>
				<div class="layui-inline">
					<div class="layui-form-item">
						派件网点
					</div>
					<div class="layui-form-item" style="width: 160px;">
						<select name="deliveryOutlets" id="deliveryOutlets" lay-verify="required">
							<option value=""></option>
						</select>
					</div>
				</div>

			</div>
			<div class="layui-form-item" style="margin-top: -25px;">
				<div class="layui-inline">
					<div class="layui-form-item">
						走货路线
					</div>
					<div class="layui-form-item" id="aa" style="width: 680px;">
						<select name="takeTheCargoRoute" id="takeTheCargoRoute" lay-verify="required">
							<option value=""></option>
						</select>
					</div>
				</div>
			</div>
			<div class="layui-form-item" style="margin-top: -25px;">
				<div class="layui-inline">
					<div class="layui-form-item">
						<div class="layui-tab" style="width: 680px;">
							<ul class="layui-tab-title">
								<li class="layui-this">目的地编码</li>
								<li style="margin-left: 150px;">英文目的地</li>
								<li style="margin-left: 150px;">简体目的地</li>
							</ul>
							<div class="layui-tab-content">
								<div class="layui-tab-item layui-show">
									<textarea name="countryCode" id="countryCode" style="width: 670px;height: 200px;" placeholder="请输入内容" class="layui-textarea"></textarea>
								</div>
								<div class="layui-tab-item">
									<textarea name="simplifiedName" id="simplifiedName" style="width: 670px;height: 200px;" placeholder="请输入内容" class="layui-textarea"></textarea>
								</div>
								<div class="layui-tab-item">
									<textarea name="englishName" id="englishName" style="width: 670px;height: 200px;" placeholder="请输入内容" class="layui-textarea"></textarea>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="layui-form-item" style="margin-top: -25px;">
				<div class="layui-inline">
					<div class="layui-form-item">
						整袋限制重量（KG）
					</div>
					<div class="layui-form-item">
						<div class="layui-inline">
							<input type="text" name="restrictedWeightPerTicket1" id="restrictedWeightPerTicket1" style="width: 60px;" required lay-verify="required" autocomplete="off" class="layui-input">
						</div>
						<div class="layui-inline">
							<span style="color: red;">~</span>
						</div>
						<div class="layui-inline">
							<input type="text" name="restrictedWeightPerTicket2" id="restrictedWeightPerTicket2" style="width: 60px;" required lay-verify="required" autocomplete="off" class="layui-input">
						</div>
					</div>
				</div>
				<div class="layui-inline">
					<div class="layui-form-item">
						单票限制申报价值
					</div>
					<div class="layui-form-item">
						<div class="layui-inline">
							<input type="text" name="limitedValueOfSingleTicket1" id="limitedValueOfSingleTicket1" style="width: 60px;" required lay-verify="required" autocomplete="off" class="layui-input">
						</div>
						<div class="layui-inline">
							<span style="color: red;">~</span>
						</div>
						<div class="layui-inline">
							<input type="text" name="limitedValueOfSingleTicket2" id="limitedValueOfSingleTicket2" style="width: 60px;" required lay-verify="required" autocomplete="off" class="layui-input">
						</div>
					</div>
				</div>
				<div class="layui-inline">
					<div class="layui-form-item">
						报关方式
					</div>
					<div class="layui-form-item" style="width: 150px;">
						<select name="customsDeclarationMethod" id="customsDeclarationMethod" lay-verify="required">
							<option value=""></option>
						</select>
					</div>
				</div>
				<div class="layui-inline">
					<div class="layui-form-item">
						货物类型
					</div>
					<div class="layui-form-item" style="width: 150px;">
						<select name="goodsType" id="goodsType" lay-verify="required">
							<option value=""></option>
						</select>
					</div>
				</div>
			</div>
			<div class="layui-form-item" style="margin-top: -25px;">
				<div class="layui-inline">
					<div class="layui-form-item">
						目的机场代码
					</div>
					<div class="layui-form-item" style="width: 200px;">
						<input type="text" name="destinationAirportCode" id="destinationAirportCode" required lay-verify="required" placeholder="请输入标题" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-inline">
					<div class="layui-form-item">
						邮包互换局
					</div>
					<div class="layui-form-item" style="width: 200px;">
						<input type="text" name="parcelExchangeOffice" id="parcelExchangeOffice" required lay-verify="required" placeholder="请输入标题" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-inline">
					<div class="layui-form-item">
						备注
					</div>
					<div class="layui-form-item" style="width: 250px;">
						<input type="text" name="remarks" id="remarks" required lay-verify="required" placeholder="请输入标题" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-inline" style="margin-top: -5px;">
					<button type="button" lay-submit class="layui-btn  layui-btn-sm" style="background-color: #286ED6;" id="save_exit">保持并退出</button>
					<button type="button"  lay-submit class="layui-btn  layui-btn-sm" style="background-color: #286ED6;" id="save">保存</button>
					<button type="button" class="layui-btn  layui-btn-sm" style="background-color: #A7A9AD;" id="exit">返回</button>
				</div>
			</div>
		</div>
	</form>
</div>
</body>
<script src="../lib/layui-v2.5.4/layui.js"></script>
<script src="../js/xm-select.js"></script>
<script src="../js/jquery-1.11.3.min.js"></script>
<script>
	function setPlateNo(plateNo){
		$("#plateNo").val(plateNo);
	}

	layui.use(['layer', 'form', 'jquery', 'element'], function() {
		var $ = layui.jquery;
		var layer = layui.layer;
		var element = layui.element;
		var form = layui.form;

		function updBagging(i){
			$.ajax({
				url:"/bagging/updBagging",
				type:"post",
				dataType:'text',
				data:$("form").serialize(),
				success:function (result) {
					if(result>0){
						alert("修改成功")
					}else{
						alert("修改失败")
					}
					if(i==1){
						var index = parent.layer.getFrameIndex(window.name);
						parent.layer.close(index);//关闭当前页
					}
				}
			})
		}

		$("#save_exit").click(function () {
			form.on('submit', function(data){
				updBagging(1);
				return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
			});
		})
		$("#save").click(function () {
			form.on('submit', function(data){
				updBagging(0);
				return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
			});
		})
		$("#exit").click(function () {
			var index = parent.layer.getFrameIndex(window.name);
			parent.layer.close(index);//关闭当前页
		})

		//查询并渲染派件网点下拉框
		$("#deliveryOutlets").load("/up/getOutlet",function(result){
			$("#deliveryOutlets").append("<option value=''>请选择</option>");
			$.each(eval("("+result+")"),function(index,item){
				$("#deliveryOutlets").append("<option value='"+item.oid+"'>"+item.name+"</option>");
			})
			form.render();
			//查询并渲染货物类型下拉框
			$("#goodsType").load("/up/getGoodsType",function(result){
				$("#goodsType").append("<option value=''>请选择</option>");
				$.each(eval("("+result+")"),function(index,item){
					$("#goodsType").append("<option value='"+item.gid+"'>"+item.gname+"</option>");
				})
				form.render();
				//查询并渲染状态策略下拉框
				$("#baggingStrategy").load("/bagging/getBS",function(result){
					$("#baggingStrategy").append("<option value=''>请选择</option>");
					$.each(eval("("+result+")"),function(index,item){
						$("#baggingStrategy").append("<option value='"+item.bid+"'>"+item.baggingStrategy+"</option>");
					})
					form.render();
					//查询并渲染走货路线下拉框
					$("#takeTheCargoRoute").load("/up/getSpecificroute",function(result){
						$("#takeTheCargoRoute").append("<option value=''>请选择1</option>");
						$.each(eval("("+result+")"),function(index,item){
							$("#takeTheCargoRoute").append("<option value='"+item.sid+"'>"+item.routeName+"</option>");
						})
						form.render();
						//查询并渲染报关方式下拉框
						$("#customsDeclarationMethod").load("/up/getcdm",function(result){
							$("#customsDeclarationMethod").append("<option value=''>请选择</option>");
							$.each(eval("("+result+")"),function(index,item){
								$("#customsDeclarationMethod").append("<option value='"+item.cid+"'>"+item.customsDeclarationMethod+"</option>");
							})
							form.render();
							//查询要修改的数据并渲染
							$.ajax({
								url:"/bagging/getBagginByPlateNo",
								type:"post",
								dataType:"json",
								data:{'plateNo':$("#plateNo").val()},
								success:function(result){
									$("#plateNo").val(result.plateNo);
									$("#customsClearanceBagNo").val(result.customsClearanceBagNo);
									$("#baggingStrategy").val(result.baggingStrategy);
									$("#deliveryOutlets").val(result.deliveryOutlets);
									$("#takeTheCargoRoute").val(result.takeTheCargoRoute);
									$("#countryCode").val(result.countryCode);
									$("#simplifiedName").val(result.simplifiedName);
									$("#englishName").val(result.englishName);
									$("#restrictedWeightPerTicket1").val(result.restrictedWeightPerTicket.substring(0,result.restrictedWeightPerTicket.indexOf('~')));
									$("#restrictedWeightPerTicket2").val(result.restrictedWeightPerTicket.substring(result.restrictedWeightPerTicket.indexOf('~')+1));
									$("#limitedValueOfSingleTicket1").val(result.limitedValueOfSingleTicket.substring(0,result.limitedValueOfSingleTicket.indexOf('~')));
									$("#limitedValueOfSingleTicket2").val(result.limitedValueOfSingleTicket.substring(result.limitedValueOfSingleTicket.indexOf('~')+1));
									$("#customsDeclarationMethod").val(result.customsDeclarationMethod);
									$("#goodsType").val(result.goodsType);
									$("#destinationAirportCode").val(result.destinationAirportCode);
									$("#parcelExchangeOffice").val(result.parcelExchangeOffice);
									$("#remarks").val(result.remarks);
									form.render();
								}
							})
						})
					})
				})
			})
		})

	});
</script>
</html>
